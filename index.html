<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Price of Living: A Visual Journey Through Inflation</title>
    <link rel="stylesheet" href="css/styles.css">

    <!--
        D3.js v7 - Data-Driven Documents
        Purpose: JavaScript library for creating interactive data visualizations in the browser
        Global object: d3
        Methods used: d3.csv(), d3.select(), d3.scaleLinear(), d3.line(), d3.axisBottom(),
                     d3.geoMercator(), d3.geoPath(), d3.scaleSequential(), d3.schemeTableau10
        Source: https://d3js.org/
    -->
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <!--
        TopoJSON v3 - Topology encoding library
        Purpose: Extension of GeoJSON for encoding topology, used for efficient map geometries
        Global object: topojson
        Methods used: topojson.feature()
        Source: https://github.com/topojson/topojson
    -->
    <script src="https://unpkg.com/topojson@3"></script>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="nav-title">The Price of Living</h1>
            <ul class="nav-menu">
                <li><a href="#introduction">Introdução</a></li>
                <li><a href="#data">Dados</a></li>
                <li><a href="#visualizations">Visualizações</a></li>
                <li><a href="#conclusions">Conclusões</a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
        <div class="hero-content">
            <h1>The Price of Living</h1>
            <p>Uma Jornada Visual Através da Inflação em Portugal</p>
        </div>
    </header>

    <!-- Global Country Selector Section -->
    <section id="country-selector" class="section country-selector-section">
        <div class="container">
            <div class="selector-header">
                <h2>Selecione um País</h2>
                <p>Explore como a inflação afeta diferentes países europeus</p>
            </div>
            <div class="selector-hint">
                <svg class="hint-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 2C5.58172 2 2 5.58172 2 10C2 14.4183 5.58172 18 10 18C14.4183 18 18 14.4183 18 10C18 5.58172 14.4183 2 10 2Z" stroke="currentColor" stroke-width="2"/>
                    <path d="M10 6V10L13 13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
                Clique no mapa para escolher o país que quer analisar; os gráficos abaixo seguem imediatamente a seleção.
            </div>

            <!-- Country Search Bar -->
            <div class="country-search-container">
                <div class="search-input-wrapper">
                    <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="9" cy="9" r="6" stroke="currentColor" stroke-width="2"/>
                        <path d="M14 14L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <input
                        type="text"
                        id="country-search-input"
                        class="country-search-input"
                        placeholder="Pesquisar país..."
                        autocomplete="off"
                    />
                    <button id="clear-search" class="clear-search-btn" style="display: none;" aria-label="Limpar pesquisa">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M4 4L12 12M12 4L4 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
                <div id="search-results" class="search-results" style="display: none;"></div>
            </div>

            <div class="country-selector-map" id="country-selector-map"></div>
        </div>
    </section>

    <!-- Introduction Section -->
    <section id="introduction" class="section">
        <div class="container">
            <h2>Introdução</h2>
            <p>
                A inflação voltou a estar no centro do debate público nos últimos anos, 
                com impacto direto no custo de vida das famílias portuguesas. O aumento 
                dos preços da energia, da alimentação e da habitação tem sido sentido por 
                todos, mas afeta de forma particular os grupos mais vulneráveis.
            </p>
            <p>
                O nosso objetivo é analisar de que forma a inflação em Portugal afeta 
                diferentes dimensões do dia a dia: preços, salários, habitação e desigualdade social.
            </p>
            
            <div class="questions-box">
                <h3>Questões Principais</h3>
                <ul>
                    <li>Quanto aumentou a inflação em Portugal no total e em cada categoria de bens e serviços?</li>
                    <li>Os salários acompanharam a subida de preços ou houve perda de poder de compra?</li>
                    <li>Como Portugal se compara com a União Europeia?</li>
                    <li>A inflação afetou a distribuição do rendimento e os 40% mais pobres?</li>
                </ul>
            </div>
        </div>
    </section>

    <!-- Data Section -->
    <section id="data" class="section section-alt">
        <div class="container">
            <h2>Dados</h2>
            <p>
                Para a nossa análise recorremos a dados da <strong>Pordata</strong>, 
                que compila estatísticas oficiais do INE e do Eurostat.
            </p>
            
            <div class="data-sources">
                <div class="data-card">
                    <h3>Índice de Preços no Consumidor (IPC)</h3>
                    <p>Mostra como os preços evoluem em diferentes categorias, como alimentação ou transportes.</p>
                </div>

                <div class="data-card">
                    <h3>Salário Mínimo Nacional</h3>
                    <p>Permite avaliar se os rendimentos acompanharam a subida dos preços.</p>
                </div>

                <div class="data-card">
                    <h3>Índice Harmonizado de Preços (HICP)</h3>
                    <p>Garante comparabilidade com a média da União Europeia.</p>
                </div>

                <div class="data-card">
                    <h3>Quota de Rendimento dos 40% Mais Pobres</h3>
                    <p>Mostra como é distribuído o rendimento em Portugal.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Visualizations Section -->
    <section id="visualizations" class="section">
        <div class="container">
            <h2>Visualizações</h2>
            <p>Explore os dados de forma interativa através das visualizações abaixo.</p>
            
            <!-- Visualization 1: Inflation by Category -->
            <div class="visualization-container">
                <h3>Taxa de Inflação por Bens e Serviços</h3>
                <p class="viz-description">
                    Evolução da taxa de inflação por diferentes categorias de bens e serviços desde 1996.
                </p>
                <p class="viz-source">
                    <strong>Fonte:</strong> <a href="https://www.pordata.pt/pt/estatisticas/inflacao/taxa-de-inflacao/taxa-de-inflacao-por-bens-e-servicos-portugal" target="_blank" rel="noopener noreferrer">Pordata - Taxa de Inflação por Bens e Serviços (Europa)</a>
                </p>

                <!-- Visualization Mode Buttons -->
                <div class="viz-controls">
                    <button id="btn-timeline-view" class="viz-button active">Ao longo dos anos</button>
                    <button id="btn-radar-view" class="viz-button">Por categoria</button>
                </div>

                <!-- Category filter for line chart -->
                <div id="category-filter-container" class="category-filter-section" style="display: block;"></div>

                <!-- Year selection for radar chart -->
                <div id="year-selection-container" class="year-selection" style="display: none;">
                    <div id="year-checkboxes" class="year-checkboxes"></div>
                </div>

                <div id="viz-inflation-categories" class="viz-canvas"></div>
            </div>

            <!-- Visualization 2: Bullet Graph - Wage Analysis -->
            <div class="visualization-container">
                <h3>Análise do Poder de Compra do Salário Mínimo</h3>
                <p class="viz-description">
                    Comparação entre o salário mínimo nominal e o salário real (ajustado pela inflação) face ao ano base de 2020.
                </p>
                <p class="viz-source">
                    <strong>Fontes:</strong> <a href="https://www.pordata.pt/pt/estatisticas/salarios-e-pensoes/salarios/salario-minimo-nacional" target="_blank" rel="noopener noreferrer">Pordata - Salário Mínimo Nacional</a> | <a href="https://www.pordata.pt/pt/estatisticas/inflacao/taxa-de-inflacao/taxa-de-inflacao-por-bens-e-servicos-portugal" target="_blank" rel="noopener noreferrer">Taxa de Inflação</a>
                </p>

                <!-- Year selector for bullet graph -->
                <div class="bullet-controls">
                    <label for="year-select">Selecione o ano:</label>
                    <div id="bullet-year-selector"></div>
                </div>

                <div id="viz-bullet-graph" class="viz-canvas"></div>
            </div>

            <!-- Visualization 3: Choropleth Map - Europe HICP -->
            <div class="visualization-container">
                <h3>Índice Harmonizado de Preços no Consumidor (HICP) - Europa</h3>
                <p class="viz-description">
                    Comparação da inflação entre países europeus. Passe o rato sobre cada país para ver os detalhes.
                </p>
                <p class="viz-source">
                    <strong>Fonte:</strong> <a href="https://www.pordata.pt/pt/estatisticas/inflacao/taxa-de-inflacao/taxa-de-inflacao-por-bens-e-servicos-portugal-na-europa" target="_blank" rel="noopener noreferrer">Pordata - Taxa de Inflação por Bens e Serviços (Portugal na Europa)</a>
                </p>

                <!-- Map controls -->
                <div class="map-controls">
                    <div class="map-control-group">
                        <label for="map-year-select">Ano:</label>
                        <select id="map-year-select" class="map-select"></select>
                    </div>
                    <div class="map-control-group">
                        <label for="map-category-select">Categoria:</label>
                        <select id="map-category-select" class="map-select"></select>
                    </div>
                </div>

                <div id="map-country-summary" class="map-country-summary"></div>

                <div id="viz-choropleth-map" class="viz-canvas"></div>
            </div>

            <!-- Visualization 4: Scatter Plot - Income vs Inflation -->
            <div class="visualization-container">
                <h3>Inflação e Rendimento dos 40% Mais Pobres</h3>
                <p class="viz-description">
                    Análise da relação entre a inflação e a distribuição de rendimento em
                    <span id="scatter-description-country">Portugal</span> (2000-2024).
                </p>
                <p class="viz-source">
                    <strong>Fontes:</strong> <a href="https://www.pordata.pt/pt/estatisticas/pobreza/desigualdade-na-distribuicao-dos-rendimentos/rendimento-dos-40-mais-pobres-da" target="_blank" rel="noopener noreferrer">Pordata - Rendimento dos 40% Mais Pobres</a> | <a href="https://www.pordata.pt/pt/estatisticas/inflacao/taxa-de-inflacao/taxa-de-inflacao-por-bens-e-servicos-portugal" target="_blank" rel="noopener noreferrer">Taxa de Inflação</a>
                </p>

                <!-- Scatter view buttons -->
                <div class="viz-controls">
                    <button id="btn-scatter-variation" class="viz-button active">Poder de Compra</button>
                    <button id="btn-scatter-timeline" class="viz-button">Evolução Temporal</button>
                </div>

                <!-- Dynamic descriptions for each view -->
                <div id="scatter-description" class="viz-interpretation">
                    <p id="scatter-variation-desc" style="display: block;">
                        <strong>Análise do Poder de Compra:</strong> Este gráfico relaciona a variação anual da quota
                        de rendimento dos 40% mais pobres (eixo Y) com a variação da inflação (eixo X). Cada ponto
                        representa um ano. As cores indicam cenários distintos: <span style="color: #27ae60;">●</span>
                        verde = melhor cenário (rendimento sobe, inflação desce); <span style="color: #e74c3c;">●</span>
                        vermelho = pior cenário (rendimento desce, inflação sobe); <span style="color: #f39c12;">●</span>
                        laranja = cenário misto positivo; <span style="color: #3498db;">●</span> azul = cenário misto.
                        Pontos no quadrante superior esquerdo indicam ganhos de poder de compra, enquanto no quadrante
                        inferior direito indicam perdas significativas. Anos de choques inflacionários (2022-2023) aparecem
                        claramente à direita do gráfico.
                    </p>
                    <p id="scatter-timeline-desc" style="display: none;">
                        <strong>Evolução Temporal do Poder de Compra:</strong> Este gráfico mostra a trajetória do
                        índice de poder de compra ao longo do tempo (2001-2024). O índice é calculado como a diferença
                        entre a variação do rendimento e a variação da inflação. Valores <strong>positivos</strong>
                        (acima da linha zero, pontos verdes) indicam anos em que o rendimento dos 40% mais pobres cresceu
                        mais que a inflação, representando <strong>ganhos de poder de compra</strong>. Valores
                        <strong>negativos</strong> (abaixo da linha zero, pontos vermelhos) indicam <strong>perdas</strong>.
                        A área colorida facilita a visualização dos períodos de melhoria (verde) versus deterioração
                        (vermelho) do poder de compra. Identifique facilmente os anos críticos onde a inflação superou
                        os ganhos de rendimento.
                    </p>
                </div>

                <div id="viz-scatter-plot" class="viz-canvas"></div>
            </div>

            <!-- Visualization 5: Country Comparison -->
            <div class="visualization-container">
                <h3>Comparação entre Países</h3>
                <p class="viz-description">
                    Compare Portugal com outro país europeu num gráfico de quadrantes: o eixo X mostra a inflação total (%) e o eixo Y o índice real do salário mínimo (base comum quando disponível), enquanto os cartões destacam o salário nominal e o salário real ajustado em euros para cada país.
                </p>
                <p class="viz-source">
                    <strong>Fontes:</strong> Mesmos ficheiros de inflação e salário mínimo utilizados nas visualizações anteriores.
                </p>

                <div id="country-comparison" class="comparison-widget">
                    <div class="comparison-loading-fallback">A preparar a comparação interactiva…</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Conclusions Section -->
    <section id="conclusions" class="section section-alt">
        <div class="container">
            <h2>Conclusões</h2>
            <p>
                A análise cruzada entre preços, salários e mapas europeus mostra que a inflação recente
                é um fenómeno multidimensional: mexe no orçamento mensal, redefine a comparação com a UE
                e agrava disparidades sociais quando não é acompanhada por ganhos reais.
            </p>

            <div class="conclusion-grid">
                <article class="conclusion-card">
                    <h3>Impacto no consumo diário</h3>
                    <p>
                        Energia, alimentação e habitação continuaram a liderar os aumentos de preços.
                        Mesmo após o pico de 2022, estas categorias mantêm taxas acima da média, o que
                        significa que a inflação ainda é sentida nos bens essenciais.
                    </p>
                </article>

                <article class="conclusion-card">
                    <h3>Salário mínimo: progresso lento</h3>
                    <p>
                        O salário mínimo nominal cresceu, mas o salário real só recuperou quando alinhado
                        a um ano base comum (2020). Em vários países o ganho nominal não foi suficiente para
                        compensar a perda de poder de compra causada pela inflação acumulada.
                    </p>
                </article>

                <article class="conclusion-card">
                    <h3>Comparação europeia e desigualdade</h3>
                    <p>
                        O mapa HICP mostra que Portugal esteve abaixo das economias mais pressionadas,
                        mas o scatter dos 40% mais pobres evidencia como choques inflacionários reduziram
                        a quota de rendimento. Mitigar desigualdades continua a depender de políticas salariais.
                    </p>
                </article>
            </div>

            <p class="conclusion-footnote">
                Em síntese, controlar a inflação não basta: é necessário sincronizar salários reais,
                políticas energéticas e proteção dos rendimentos mais baixos para preservar o poder de compra.
            </p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>
                Desenvolvido por <strong>Ângela Ribeiro</strong> (109061) e 
                <strong>Hugo Castro</strong> (113889)
            </p>
            <p>
                Universidade de Aveiro - DETI<br>
                Information Visualisation 2025/2026
            </p>
        </div>
    </footer>

    <button id="back-to-top" class="back-to-top" type="button" aria-label="Voltar ao topo">
        <span aria-hidden="true">▲ Topo</span>
    </button>

    <!-- JavaScript (ES6 Modules) -->
    <script type="module" src="src/main.js"></script>
</body>
</html>
